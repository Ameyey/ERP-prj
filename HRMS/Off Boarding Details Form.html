<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Employee Onboarding Form</title>
  <link rel="stylesheet" href="hrms.css">
  <link rel="stylesheet" href="sty.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
 <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
 <div th:replace="~{HRMS.html :: sidebarFragment}"></div> <!-- // for side bar code  -->
 
  <div class="form-container" style="max-width: 986px;margin: 62px auto auto 400px;">
  
    <form id="onboardingForm" enctype="multipart/form-data">
    
      <input type="hidden" id="id" name="id" th:value="${onboarding?.id}">
      
      <h2>Employee Onboarding Form</h2>
      <!-- First Row -->
     
       <br>
      <div class="form-row">
        <div class="form-group">
          <label for="employeeuid">Employee UID:</label>
          <select id="employeeuid" name="employeeuid" onchange="fetchEmployeeDetails(this.value)" >
              <option value="">Select Employee UID</option>
              <option th:each="uid : ${employeeuid}" th:value="${uid}" th:text="${uid}"></option>
          </select>
        </div>
       <div class="form-group">
          <label>First Name:</label>
          <input type="text" id="first_name" name="first_name" readonly>
        </div>
        <div class="form-group">
          <label>Last Name:</label>
          <input type="text" id="last_name" name="last_name" readonly>
        </div>
        <div class="form-group">
          <label>Department Name:</label>
          <input type="text" id="departmentname" name="departmentname" readonly>
        </div>
        <div class="form-group">
          <label for="designation">Designation:</label>
          <input type="text" id="designation" name="designation"  th:value="${onboarding?.designation}">
        </div>  
       
      </div>
      <br>
      

      <!-- Second Row -->    
      <div class="form-row">
        <div class="form-group">
          <label for="dateofjoining">Date of Joining:</label>
        <input type="date" id="dateofjoining" name="dateofjoining"  th:value="${onboarding?.dateofjoining}">
        </div>
       
        <div class="form-group" >      
          <label for="academiccertificates" style="font-size: 13px;">Academic Certificates:</label>
          <select id="academiccertificates" name="academiccertificates"  th:value="${onboarding?.academiccertificates}">
              <option value="Submitted" th:selected="${onboarding?.academiccertificates == 'Submitted'}">Submitted</option>
              <option value="Pending" th:selected="${onboarding?.academiccertificates == 'Pending'}">Pending</option>
          </select>
        </div>      
        <div class="form-group">
          <label for="identityproof">Identity Proof:</label>
          <select id="identityproof" name="identityproof"  th:value="${onboarding?.identityproof}">
              <option value="Submitted" th:selected="${onboarding?.identityproof == 'Submitted'}">Submitted</option>
              <option value="Pending" th:selected="${onboarding?.identityproof == 'Pending'}">Pending</option>
          </select>
        </div>             
        <div class="form-group">
          <label for="taxdocuments">Tax Documents:</label>
          <select id="taxdocuments" name="taxdocuments"  th:value="${onboarding?.taxdocuments}">
              <option value="Submitted" th:selected="${onboarding?.taxdocuments == 'Submitted'}">Submitted</option>
              <option value="Pending" th:selected="${onboarding?.taxdocuments == 'Pending'}" >Pending</option>
          </select>
        </div>
        <div class="form-group">        
          <label for="offerlettersigned">Offer Letter Signed:</label>
          <select id="offerlettersigned" name="offerlettersigned"  th:value="${onboarding?.offerlettersigned}">
              <option value="Submitted" th:selected="${onboarding?.offerlettersigned == 'Submitted'}">Submitted</option>
              <option value="Pending" th:selected="${onboarding?.offerlettersigned == 'Pending'}" >Pending</option>
          </select>
        </div>
      </div>
      <br>

      <div class="form-row">
        <div class="form-group">
          <div class="form-group">
            <label for="managername">Manager Name:</label>
          <select id="managername" name="managername"  th:value="${onboarding?.managername}">
              <option value="">-- Select Manager --</option>
              <option value="Manager1" th:selected="${onboarding?.managername == 'Manager1'}">Manager 1</option>
              <option value="Manager2" th:selected="${onboarding?.managername == 'Manager2'}">Manager 2</option>
          </select>
          </div> 
        </div> 
      </div>

     
    <div class="form-row"> 
     <div class="form-group">
        <label for="employeeagreementsigned" style="font-size: 13px;">Employee Agreement Signed:</label>
        <select id="employeeagreementsigned" name="employeeagreementsigned"  th:value="${onboarding?.employeeagreementsigned}">
            <option value="Submitted" th:selected="${onboarding?.employeeagreementsigned == 'Submitted'}">Submitted</option>
            <option value="Pending"   th:selected="${onboarding?.employeeagreementsigned == 'Pending'}">Pending</option>
        </select>
      </div>
      <div class="form-group">
        <label for="systemaccess">System Access:</label>
        <br>
        <input type="text" id="systemaccess" name="systemaccess"  th:value="${onboarding?.systemaccess}">
      </div>
      <div class="form-group">
        <label for="accesstype">Access Type:</label>
        <br>
        <input type="text" id="accesstype" name="accesstype"  th:value="${onboarding?.accesstype}">
      </div>
      <div class="form-group">
        <label for="levelofaccess">Level of Access:</label>
        <br>
        <input type="text" id="levelofaccess" name="levelofaccess"  th:value="${onboarding?.levelofaccess}">
      </div>
      <div class="form-group">
        <label for="orientationdate">Orientation Date:</label>
        <br>
        <input type="date" id="orientationdate" name="orientationdate"  th:value="${onboarding?.orientationdate}">
      </div>
    </div>
 
   
  
    <div class="form-row">
      <div class="form-group">
        <label for="mandatorytrainingprogram" style="font-size: 13px;">Mandatory Training Program:</label>
        <input type="text" id="mandatorytrainingprogram" name="mandatorytrainingprogram"  th:value="${onboarding?.mandatorytrainingprogram}">
      </div>
      <div class="form-group">
        <label for="assetid">Asset ID:</label>
        <br>        
        <input type="text" id="assetid" name="assetid"  th:value="${onboarding?.assetid}">
      </div>
      <div class="form-group">
        
        <label for="assetname">Asset Name:</label>
        <br>        
        <input type="text" id="assetname" name="assetname"  th:value="${onboarding?.assetname}">
      </div>
      <div class="form-group">
        <label for="assettype">Asset Type:</label>
        <br>        
        <input type="text" id="assettype" name="assettype"  th:value="${onboarding?.assettype}">
      </div>
      <div class="form-group">
        <label for="assignedto">Assigned To:</label>
        <br>        
        <input type="text" id="assignedto" name="assignedto"  th:value="${onboarding?.assignedto}">
      </div>
   
    </div>

    <div class="form-row">
      
        <div class="form-group">
          <label for="allocationdate">Allocation Date:</label>
          <br>
          <input type="date" id="allocationdate" name="allocationdate"  th:value="${onboarding?.allocationdate}">
        </div>
      <div class="form-group">
        <label for="conditionatallocation" style="font-size: 13px;">Condition at Allocation:</label>
        <br>
        <input type="text" id="conditionatallocation" name="conditionatallocation"  th:value="${onboarding?.conditionatallocation}">
      </div>
      <div class="form-group">
        <label for="serialnumber">Serial Number:</label>
        <br>
        <input type="text" id="serialnumber" name="serialnumber"  th:value="${onboarding?.serialnumber}">
      </div>
      <div class="form-group">
        <label for="configurationdetails">Configuration Details:</label>
        <br>
        <input type="text" id="configurationdetails" name="configurationdetails"  th:value="${onboarding?.configurationdetails}"></input>
      </div>
      <div class="form-group">
        <label for="approvedby">Approved By:</label>
        <br>
        <input type="text" id="approvedby" name="approvedby"  th:value="${onboarding?.approvedby}">
      </div>
    </div>
    </form>
   
  
      <div class="form-actions">
        <!-- <button type="button" onclick="submitAppraisalForm()">Submit Appraisal</button>
				<div th:if="${successMessage}" class="success-message" th:text="${successMessage}"></div> -->
        <button type="button" id="submitBtn" onclick="submitForm()">Submit</button>
        <div th:if="${successMessage}" class="success-message" th:text="${successMessage}"></div>
      </div>
       </div>
   
<script>
  function fetchEmployeeDetails(employeeuid) {
          if (!employeeuid) return;

          $.ajax({
          url: '/onboarding/edetails',
              method: 'GET',
              data: { employeeuid: employeeuid },
              success: function(response) {
                  if (response) {
                	  $('#first_name').val(response.firstName);
                      $('#last_name').val(response.lastName);
                      $('#departmentname').val(response.departmentName);
					}
              },
              error: function() {
                  alert('Error fetching employee details. Please try again.');
              }
          });
      }
  
function submitForm() {
            const formData = new FormData(document.getElementById('onboardingForm'));
            const id = $('#id').val();
            let url, successMessage;

            if (!id) {
                url = '/saveform';
                successMessage = 'Onboarding saved successfully!';
            } else {
                url = '/updateonboarding';
                successMessage = 'Onboarding updated successfully!';
            }

            $.ajax({
                url: url,
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function(response) {
                    alert(successMessage);
                    resetForm();
                    window.location.href = '/boardinglist';
                },
                error: function() {
                    alert('Error saving onboarding level. Please try again.');
                }
            });
        }

        function resetForm() {
            $('#onboarding')[0].reset();
            $('#id').val('');
            $('#form-title').text('Onboarding Form');
            $('#submitBtn').text('Submit');
        }

        function prefillForm(data) {
            $('#id').val(data.id);
            $('#employeeuid').val(data.employeeuid);
            $('#employeename').val(data.employeename);
            $('#department').val(data.department);
            $('#designation').val(data.designation);
            $('#dateofjoining').val(data.dateofjoining);
            $('#managername').val(data.managername);
            $('#academiccertificates').val(data.academiccertificates);
            $('#identityproof').val(data.identityproof);
            $('#taxdocuments').val(data.taxdocuments);
            $('#offerlettersigned').val(data.offerlettersigned);
            $('#employeeagreementsigned').val(data.employeeagreementsigned);
      $('#systemaccess').val(data.systemaccess);
      $('#accesstype').val(data.accesstype);
      $('#levelofaccess').val(data.levelofaccess);
      $('#orientationdate').val(data.orientationdate);
      $('#mandatorytrainingprogram').val(data.mandatorytrainingprogram);
      $('#assetid').val(data.assetid);
      $('#assetname').val(data.assetname);
      $('#assettype').val(data.assettype);
      $('#assignedto').val(data.assignedto);
      $('#allocationdate').val(data.allocationdate);
      $('#conditionatallocation').val(data.conditionatallocation);
      $('#serialnumber').val(data.serialnumber);
      $('#configurationdetails').val(data.configurationdetails);
      $('#approvedby').val(data.approvedby);

            $('#form-title').text('Update Onboarding Level');
            $('#submitBtn').text('Update');
      
      

         
        }
</script>
</body>
</html>